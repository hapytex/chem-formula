<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE RankNTypes          #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ParallelListComp    #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# OPTIONS_HADDOCK show-extensions #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-comment">{-|
Module      : Data.ExactPi
Description : Exact rational multiples of powers of pi
License     : MIT
Maintainer  : douglas.mcclean@gmail.com
Stability   : experimental

This type is sufficient to exactly express the closure of Q &#8746; {&#960;} under multiplication and division.
As a result it is useful for representing conversion factors
between physical units. Approximate values are included both to close the remainder
of the arithmetic operations in the `Num` typeclass and to encode conversion
factors defined experimentally.
-}</span><span>
</span><span id="line-19"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.ExactPi</span><span>
</span><span id="line-20"></span><span class="hs-special">(</span><span>
</span><span id="line-21"></span><span>  </span><span class="annot"><a href="Data.ExactPi.html#ExactPi"><span class="hs-identifier">ExactPi</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>  </span><span class="annot"><a href="Data.ExactPi.html#approximateValue"><span class="hs-identifier">approximateValue</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>  </span><span class="annot"><a href="Data.ExactPi.html#isZero"><span class="hs-identifier">isZero</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>  </span><span class="annot"><a href="Data.ExactPi.html#isExact"><span class="hs-identifier">isExact</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><a href="Data.ExactPi.html#isExactZero"><span class="hs-identifier">isExactZero</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>  </span><span class="annot"><a href="Data.ExactPi.html#isExactOne"><span class="hs-identifier">isExactOne</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><a href="Data.ExactPi.html#areExactlyEqual"><span class="hs-identifier">areExactlyEqual</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>  </span><span class="annot"><a href="Data.ExactPi.html#isExactInteger"><span class="hs-identifier">isExactInteger</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><a href="Data.ExactPi.html#toExactInteger"><span class="hs-identifier">toExactInteger</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><a href="Data.ExactPi.html#isExactRational"><span class="hs-identifier">isExactRational</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>  </span><span class="annot"><a href="Data.ExactPi.html#toExactRational"><span class="hs-identifier">toExactRational</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>  </span><span class="annot"><a href="Data.ExactPi.html#rationalApproximations"><span class="hs-identifier">rationalApproximations</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Utils</span></span><span>
</span><span id="line-34"></span><span>  </span><span class="annot"><a href="Data.ExactPi.html#getRationalLimit"><span class="hs-identifier">getRationalLimit</span></a></span><span>
</span><span id="line-35"></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">where</span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Monoid</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Ratio</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(%)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">numerator</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">denominator</span></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Semigroup</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-comment">-- | Represents an exact or approximate real value.</span><span>
</span><span id="line-44"></span><span class="hs-comment">-- The exactly representable values are rational multiples of an integer power of pi.</span><span>
</span><span id="line-45"></span><span class="hs-keyword">data</span><span> </span><span id="ExactPi"><span class="annot"><a href="Data.ExactPi.html#ExactPi"><span class="hs-identifier hs-var">ExactPi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Exact"><span class="annot"><a href="Data.ExactPi.html#Exact"><span class="hs-identifier hs-var">Exact</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span> </span><span class="hs-comment">-- ^ @'Exact' z q@ = q * pi^z. Note that this means there are many representations of zero.</span><span>
</span><span id="line-46"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span id="Approximate"><span class="annot"><a href="Data.ExactPi.html#Approximate"><span class="hs-identifier hs-var">Approximate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679047862"><span class="annot"><a href="#local-6989586621679047862"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="annot"><a href="#local-6989586621679047862"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679047862"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ An approximate value. This representation was chosen because it allows conversion to floating types using their native definition of 'pi'.</span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-comment">-- | Approximates an exact or approximate value, converting it to a `Floating` type.</span><span>
</span><span id="line-49"></span><span class="hs-comment">-- This uses the value of `pi` supplied by the destination type, to provide the appropriate</span><span>
</span><span id="line-50"></span><span class="hs-comment">-- precision.</span><span>
</span><span id="line-51"></span><span id="local-6989586621679047891"><span class="annot"><a href="Data.ExactPi.html#approximateValue"><span class="hs-identifier hs-type">approximateValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="annot"><a href="#local-6989586621679047891"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.ExactPi.html#ExactPi"><span class="hs-identifier hs-type">ExactPi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679047891"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-52"></span><span id="approximateValue"><span class="annot"><span class="annottext">approximateValue :: ExactPi -&gt; a
</span><a href="Data.ExactPi.html#approximateValue"><span class="hs-identifier hs-var hs-var">approximateValue</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ExactPi.html#Exact"><span class="hs-identifier hs-type">Exact</span></a></span><span> </span><span id="local-6989586621679047861"><span class="annot"><span class="annottext">z :: Integer
</span><a href="#local-6989586621679047861"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span id="local-6989586621679047860"><span class="annot"><span class="annottext">q :: Rational
</span><a href="#local-6989586621679047860"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Integer -&gt; a
forall a b. (Fractional a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^^</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679047861"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; a
forall a. Fractional a =&gt; Rational -&gt; a
</span><span class="hs-identifier hs-var">fromRational</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679047860"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="annot"><a href="Data.ExactPi.html#approximateValue"><span class="hs-identifier hs-var">approximateValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ExactPi.html#Approximate"><span class="hs-identifier hs-type">Approximate</span></a></span><span> </span><span id="local-6989586621679047856"><span class="annot"><span class="annottext">x :: forall a. Floating a =&gt; a
</span><a href="#local-6989586621679047856"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
forall a. Floating a =&gt; a
</span><a href="#local-6989586621679047856"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-comment">-- | Identifies whether an 'ExactPi' is an exact or approximate representation of zero.</span><span>
</span><span id="line-56"></span><span class="annot"><a href="Data.ExactPi.html#isZero"><span class="hs-identifier hs-type">isZero</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ExactPi.html#ExactPi"><span class="hs-identifier hs-type">ExactPi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-57"></span><span id="isZero"><span class="annot"><span class="annottext">isZero :: ExactPi -&gt; Bool
</span><a href="Data.ExactPi.html#isZero"><span class="hs-identifier hs-var hs-var">isZero</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ExactPi.html#Exact"><span class="hs-identifier hs-type">Exact</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-58"></span><span class="annot"><a href="Data.ExactPi.html#isZero"><span class="hs-identifier hs-var">isZero</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ExactPi.html#Approximate"><span class="hs-identifier hs-type">Approximate</span></a></span><span> </span><span id="local-6989586621679047855"><span class="annot"><span class="annottext">x :: forall a. Floating a =&gt; a
</span><a href="#local-6989586621679047855"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><a href="#local-6989586621679047855"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="annot"><a href="Data.ExactPi.html#isZero"><span class="hs-identifier hs-var">isZero</span></a></span><span> </span><span class="hs-identifier">_</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-comment">-- | Identifies whether an 'ExactPi' is an exact value.</span><span>
</span><span id="line-62"></span><span class="annot"><a href="Data.ExactPi.html#isExact"><span class="hs-identifier hs-type">isExact</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ExactPi.html#ExactPi"><span class="hs-identifier hs-type">ExactPi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-63"></span><span id="isExact"><span class="annot"><span class="annottext">isExact :: ExactPi -&gt; Bool
</span><a href="Data.ExactPi.html#isExact"><span class="hs-identifier hs-var hs-var">isExact</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ExactPi.html#Exact"><span class="hs-identifier hs-type">Exact</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-64"></span><span class="annot"><a href="Data.ExactPi.html#isExact"><span class="hs-identifier hs-var">isExact</span></a></span><span> </span><span class="hs-identifier">_</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-comment">-- | Identifies whether an 'ExactPi' is an exact representation of zero.</span><span>
</span><span id="line-67"></span><span class="annot"><a href="Data.ExactPi.html#isExactZero"><span class="hs-identifier hs-type">isExactZero</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ExactPi.html#ExactPi"><span class="hs-identifier hs-type">ExactPi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-68"></span><span id="isExactZero"><span class="annot"><span class="annottext">isExactZero :: ExactPi -&gt; Bool
</span><a href="Data.ExactPi.html#isExactZero"><span class="hs-identifier hs-var hs-var">isExactZero</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ExactPi.html#Exact"><span class="hs-identifier hs-type">Exact</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-69"></span><span class="annot"><a href="Data.ExactPi.html#isExactZero"><span class="hs-identifier hs-var">isExactZero</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-comment">-- | Identifies whether an 'ExactPi' is an exact representation of one.</span><span>
</span><span id="line-72"></span><span class="annot"><a href="Data.ExactPi.html#isExactOne"><span class="hs-identifier hs-type">isExactOne</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ExactPi.html#ExactPi"><span class="hs-identifier hs-type">ExactPi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-73"></span><span id="isExactOne"><span class="annot"><span class="annottext">isExactOne :: ExactPi -&gt; Bool
</span><a href="Data.ExactPi.html#isExactOne"><span class="hs-identifier hs-var hs-var">isExactOne</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ExactPi.html#Exact"><span class="hs-identifier hs-type">Exact</span></a></span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-74"></span><span class="annot"><a href="Data.ExactPi.html#isExactOne"><span class="hs-identifier hs-var">isExactOne</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-comment">-- | Identifies whether two 'ExactPi' values are exactly equal.</span><span>
</span><span id="line-77"></span><span class="annot"><a href="Data.ExactPi.html#areExactlyEqual"><span class="hs-identifier hs-type">areExactlyEqual</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ExactPi.html#ExactPi"><span class="hs-identifier hs-type">ExactPi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ExactPi.html#ExactPi"><span class="hs-identifier hs-type">ExactPi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-78"></span><span id="areExactlyEqual"><span class="annot"><span class="annottext">areExactlyEqual :: ExactPi -&gt; ExactPi -&gt; Bool
</span><a href="Data.ExactPi.html#areExactlyEqual"><span class="hs-identifier hs-var hs-var">areExactlyEqual</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ExactPi.html#Exact"><span class="hs-identifier hs-type">Exact</span></a></span><span> </span><span id="local-6989586621679047854"><span class="annot"><span class="annottext">z1 :: Integer
</span><a href="#local-6989586621679047854"><span class="hs-identifier hs-var">z1</span></a></span></span><span> </span><span id="local-6989586621679047853"><span class="annot"><span class="annottext">q1 :: Rational
</span><a href="#local-6989586621679047853"><span class="hs-identifier hs-var">q1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ExactPi.html#Exact"><span class="hs-identifier hs-type">Exact</span></a></span><span> </span><span id="local-6989586621679047852"><span class="annot"><span class="annottext">z2 :: Integer
</span><a href="#local-6989586621679047852"><span class="hs-identifier hs-var">z2</span></a></span></span><span> </span><span id="local-6989586621679047851"><span class="annot"><span class="annottext">q2 :: Rational
</span><a href="#local-6989586621679047851"><span class="hs-identifier hs-var">q2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679047854"><span class="hs-identifier hs-var">z1</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679047852"><span class="hs-identifier hs-var">z2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679047853"><span class="hs-identifier hs-var">q1</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679047851"><span class="hs-identifier hs-var">q2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679047853"><span class="hs-identifier hs-var">q1</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679047851"><span class="hs-identifier hs-var">q2</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span class="annot"><a href="Data.ExactPi.html#areExactlyEqual"><span class="hs-identifier hs-var">areExactlyEqual</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-comment">-- | Identifies whether an 'ExactPi' is an exact representation of an integer.</span><span>
</span><span id="line-82"></span><span class="annot"><a href="Data.ExactPi.html#isExactInteger"><span class="hs-identifier hs-type">isExactInteger</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ExactPi.html#ExactPi"><span class="hs-identifier hs-type">ExactPi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-83"></span><span id="isExactInteger"><span class="annot"><span class="annottext">isExactInteger :: ExactPi -&gt; Bool
</span><a href="Data.ExactPi.html#isExactInteger"><span class="hs-identifier hs-var hs-var">isExactInteger</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ExactPi.html#Exact"><span class="hs-identifier hs-type">Exact</span></a></span><span> </span><span class="hs-number">0</span><span> </span><span id="local-6989586621679047848"><span class="annot"><span class="annottext">q :: Rational
</span><a href="#local-6989586621679047848"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Integer
forall a. Ratio a -&gt; a
</span><span class="hs-identifier hs-var">denominator</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679047848"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-84"></span><span class="annot"><a href="Data.ExactPi.html#isExactInteger"><span class="hs-identifier hs-var">isExactInteger</span></a></span><span> </span><span class="hs-identifier">_</span><span>                                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="hs-comment">-- | Converts an 'ExactPi' to an exact 'Integer' or 'Nothing'.</span><span>
</span><span id="line-87"></span><span class="annot"><a href="Data.ExactPi.html#toExactInteger"><span class="hs-identifier hs-type">toExactInteger</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ExactPi.html#ExactPi"><span class="hs-identifier hs-type">ExactPi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-88"></span><span id="toExactInteger"><span class="annot"><span class="annottext">toExactInteger :: ExactPi -&gt; Maybe Integer
</span><a href="Data.ExactPi.html#toExactInteger"><span class="hs-identifier hs-var hs-var">toExactInteger</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ExactPi.html#Exact"><span class="hs-identifier hs-type">Exact</span></a></span><span> </span><span class="hs-number">0</span><span> </span><span id="local-6989586621679047847"><span class="annot"><span class="annottext">q :: Rational
</span><a href="#local-6989586621679047847"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Integer
forall a. Ratio a -&gt; a
</span><span class="hs-identifier hs-var">denominator</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679047847"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Maybe Integer
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Maybe Integer) -&gt; Integer -&gt; Maybe Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Integer
forall a. Ratio a -&gt; a
</span><span class="hs-identifier hs-var">numerator</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679047847"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-89"></span><span class="annot"><a href="Data.ExactPi.html#toExactInteger"><span class="hs-identifier hs-var">toExactInteger</span></a></span><span> </span><span class="hs-identifier">_</span><span>                                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Integer
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">-- | Identifies whether an 'ExactPi' is an exact representation of a rational.</span><span>
</span><span id="line-92"></span><span class="annot"><a href="Data.ExactPi.html#isExactRational"><span class="hs-identifier hs-type">isExactRational</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ExactPi.html#ExactPi"><span class="hs-identifier hs-type">ExactPi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-93"></span><span id="isExactRational"><span class="annot"><span class="annottext">isExactRational :: ExactPi -&gt; Bool
</span><a href="Data.ExactPi.html#isExactRational"><span class="hs-identifier hs-var hs-var">isExactRational</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ExactPi.html#Exact"><span class="hs-identifier hs-type">Exact</span></a></span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-94"></span><span class="annot"><a href="Data.ExactPi.html#isExactRational"><span class="hs-identifier hs-var">isExactRational</span></a></span><span> </span><span class="hs-identifier">_</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-comment">-- | Converts an 'ExactPi' to an exact 'Rational' or 'Nothing'.</span><span>
</span><span id="line-97"></span><span class="annot"><a href="Data.ExactPi.html#toExactRational"><span class="hs-identifier hs-type">toExactRational</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ExactPi.html#ExactPi"><span class="hs-identifier hs-type">ExactPi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span>
</span><span id="line-98"></span><span id="toExactRational"><span class="annot"><span class="annottext">toExactRational :: ExactPi -&gt; Maybe Rational
</span><a href="Data.ExactPi.html#toExactRational"><span class="hs-identifier hs-var hs-var">toExactRational</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ExactPi.html#Exact"><span class="hs-identifier hs-type">Exact</span></a></span><span> </span><span class="hs-number">0</span><span> </span><span id="local-6989586621679047846"><span class="annot"><span class="annottext">q :: Rational
</span><a href="#local-6989586621679047846"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Maybe Rational
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679047846"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-99"></span><span class="annot"><a href="Data.ExactPi.html#toExactRational"><span class="hs-identifier hs-var">toExactRational</span></a></span><span> </span><span class="hs-identifier">_</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Rational
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="hs-comment">-- | Converts an 'ExactPi' to a list of increasingly accurate rational approximations. Note</span><span>
</span><span id="line-102"></span><span class="hs-comment">-- that 'Approximate' values are converted using the 'Real' instance for 'Double' into a</span><span>
</span><span id="line-103"></span><span class="hs-comment">-- singleton list. Note that exact rationals are also converted into a singleton list.</span><span>
</span><span id="line-104"></span><span class="hs-comment">--</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- Implementation is based on Chudnovsky's algorithm.</span><span>
</span><span id="line-106"></span><span class="annot"><a href="Data.ExactPi.html#rationalApproximations"><span class="hs-identifier hs-type">rationalApproximations</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ExactPi.html#ExactPi"><span class="hs-identifier hs-type">ExactPi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span class="hs-special">]</span><span>
</span><span id="line-107"></span><span id="rationalApproximations"><span class="annot"><span class="annottext">rationalApproximations :: ExactPi -&gt; [Rational]
</span><a href="Data.ExactPi.html#rationalApproximations"><span class="hs-identifier hs-var hs-var">rationalApproximations</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ExactPi.html#Approximate"><span class="hs-identifier hs-type">Approximate</span></a></span><span> </span><span id="local-6989586621679047845"><span class="annot"><span class="annottext">x :: forall a. Floating a =&gt; a
</span><a href="#local-6989586621679047845"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double -&gt; Rational
forall a. Real a =&gt; a -&gt; Rational
</span><span class="hs-identifier hs-var">toRational</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><a href="#local-6989586621679047845"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-108"></span><span class="annot"><a href="Data.ExactPi.html#rationalApproximations"><span class="hs-identifier hs-var">rationalApproximations</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ExactPi.html#Exact"><span class="hs-identifier hs-type">Exact</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">]</span><span>
</span><span id="line-109"></span><span class="annot"><a href="Data.ExactPi.html#rationalApproximations"><span class="hs-identifier hs-var">rationalApproximations</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ExactPi.html#Exact"><span class="hs-identifier hs-type">Exact</span></a></span><span> </span><span class="hs-number">0</span><span> </span><span id="local-6989586621679047844"><span class="annot"><span class="annottext">q :: Rational
</span><a href="#local-6989586621679047844"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679047844"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-110"></span><span class="annot"><a href="Data.ExactPi.html#rationalApproximations"><span class="hs-identifier hs-var">rationalApproximations</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ExactPi.html#Exact"><span class="hs-identifier hs-type">Exact</span></a></span><span> </span><span id="local-6989586621679047843"><span class="annot"><span class="annottext">z :: Integer
</span><a href="#local-6989586621679047843"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span id="local-6989586621679047842"><span class="annot"><span class="annottext">q :: Rational
</span><a href="#local-6989586621679047842"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Bool
forall a. Integral a =&gt; a -&gt; Bool
</span><span class="hs-identifier hs-var">even</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679047843"><span class="hs-identifier hs-var">z</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679047842"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="hs-number">10005</span></span><span class="annot"><span class="annottext">Rational -&gt; Integer -&gt; Rational
forall a b. (Fractional a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^^</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679047840"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679047839"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Rational -&gt; Integer -&gt; Rational
forall a b. (Fractional a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^^</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679047843"><span class="hs-identifier hs-var">z</span></a></span><span>     </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679047839"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679047839"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Rational]
</span><a href="Data.ExactPi.html#chudnovsky"><span class="hs-identifier hs-var">chudnovsky</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679047842"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="hs-number">10005</span></span><span class="annot"><span class="annottext">Rational -&gt; Integer -&gt; Rational
forall a b. (Fractional a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^^</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679047840"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679047837"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Rational -&gt; Integer -&gt; Rational
forall a b. (Fractional a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^^</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679047843"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679047836"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679047837"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679047837"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Rational]
</span><a href="Data.ExactPi.html#chudnovsky"><span class="hs-identifier hs-var">chudnovsky</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679047836"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679047836"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Rational]
</span><a href="Data.ExactPi.html#rootApproximation"><span class="hs-identifier hs-var">rootApproximation</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679047840"><span class="annot"><span class="annottext">k :: Integer
</span><a href="#local-6989586621679047840"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679047843"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="annot"><a href="Data.ExactPi.html#chudnovsky"><span class="hs-identifier hs-type">chudnovsky</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span class="hs-special">]</span><span>
</span><span id="line-116"></span><span id="chudnovsky"><span class="annot"><span class="annottext">chudnovsky :: [Rational]
</span><a href="Data.ExactPi.html#chudnovsky"><span class="hs-identifier hs-var hs-var">chudnovsky</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">426880</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679047832"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679047832"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679047832"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Rational]
</span><a href="#local-6989586621679047831"><span class="hs-identifier hs-var">partials</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679047830"><span class="annot"><span class="annottext">lk :: [Rational]
</span><a href="#local-6989586621679047830"><span class="hs-identifier hs-var hs-var">lk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; Rational) -&gt; Rational -&gt; [Rational]
forall a. (a -&gt; a) -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">iterate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="hs-number">545140134</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-number">13591409</span></span><span>
</span><span id="line-118"></span><span>        </span><span id="local-6989586621679047827"><span class="annot"><span class="annottext">xk :: [Rational]
</span><a href="#local-6989586621679047827"><span class="hs-identifier hs-var hs-var">xk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; Rational) -&gt; Rational -&gt; [Rational]
forall a. (a -&gt; a) -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">iterate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="hs-number">262537412640768000</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-119"></span><span>        </span><span id="local-6989586621679047826"><span class="annot"><span class="annottext">kk :: [Integer]
</span><a href="#local-6989586621679047826"><span class="hs-identifier hs-var hs-var">kk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Integer) -&gt; Integer -&gt; [Integer]
forall a. (a -&gt; a) -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">iterate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="hs-number">12</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-number">6</span></span><span>
</span><span id="line-120"></span><span>        </span><span id="local-6989586621679047825"><span class="annot"><span class="annottext">mk :: [Rational]
</span><a href="#local-6989586621679047825"><span class="hs-identifier hs-var hs-var">mk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Rational -&gt; [Rational] -&gt; [Rational]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679047824"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679047823"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Int -&gt; Integer
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-number">3</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="hs-number">16</span></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679047823"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Rational
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679047821"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Integer -&gt; Int -&gt; Integer
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-number">3</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679047824"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679047824"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Rational]
</span><a href="#local-6989586621679047825"><span class="hs-identifier hs-var">mk</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679047823"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679047823"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Integer]
</span><a href="#local-6989586621679047826"><span class="hs-identifier hs-var">kk</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679047821"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679047821"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-121"></span><span>        </span><span id="local-6989586621679047820"><span class="annot"><span class="annottext">values :: [Rational]
</span><a href="#local-6989586621679047820"><span class="hs-identifier hs-var hs-var">values</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679047819"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679047818"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679047817"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679047819"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679047819"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Rational]
</span><a href="#local-6989586621679047825"><span class="hs-identifier hs-var">mk</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679047818"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679047818"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Rational]
</span><a href="#local-6989586621679047830"><span class="hs-identifier hs-var">lk</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679047817"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679047817"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Rational]
</span><a href="#local-6989586621679047827"><span class="hs-identifier hs-var">xk</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-122"></span><span>        </span><span id="local-6989586621679047831"><span class="annot"><span class="annottext">partials :: [Rational]
</span><a href="#local-6989586621679047831"><span class="hs-identifier hs-var hs-var">partials</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; Rational -&gt; Rational) -&gt; [Rational] -&gt; [Rational]
forall a. (a -&gt; a -&gt; a) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">scanl1</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span> </span><span class="annot"><span class="annottext">[Rational]
</span><a href="#local-6989586621679047820"><span class="hs-identifier hs-var">values</span></a></span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="hs-comment">-- | Given an infinite converging sequence of rationals, find their limit.</span><span>
</span><span id="line-125"></span><span class="hs-comment">-- Takes a comparison function to determine when convergence is close enough.</span><span>
</span><span id="line-126"></span><span class="hs-comment">--</span><span>
</span><span id="line-127"></span><span class="hs-comment">-- &gt;&gt;&gt; getRationalLimit (==) (rationalApproximations (Exact 1 1)) :: Double</span><span>
</span><span id="line-128"></span><span class="hs-comment">-- 3.141592653589793</span><span>
</span><span id="line-129"></span><span id="local-6989586621679047815"><span class="annot"><a href="Data.ExactPi.html#getRationalLimit"><span class="hs-identifier hs-type">getRationalLimit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679047815"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679047815"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679047815"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679047815"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-130"></span><span id="getRationalLimit"><span class="annot"><span class="annottext">getRationalLimit :: (a -&gt; a -&gt; Bool) -&gt; [Rational] -&gt; a
</span><a href="Data.ExactPi.html#getRationalLimit"><span class="hs-identifier hs-var hs-var">getRationalLimit</span></a></span></span><span> </span><span id="local-6989586621679047814"><span class="annot"><span class="annottext">cmp :: a -&gt; a -&gt; Bool
</span><a href="#local-6989586621679047814"><span class="hs-identifier hs-var">cmp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a
</span><a href="#local-6989586621679047813"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; a) -&gt; ([Rational] -&gt; [a]) -&gt; [Rational] -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; a) -&gt; [Rational] -&gt; [a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; a
forall a. Fractional a =&gt; Rational -&gt; a
</span><span class="hs-identifier hs-var">fromRational</span></span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679047813"><span class="annot"><span class="annottext">go :: [a] -&gt; a
</span><a href="#local-6989586621679047813"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679047811"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621679047811"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679047810"><span class="annot"><span class="annottext">y :: a
</span><a href="#local-6989586621679047810"><span class="hs-identifier hs-var">y</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679047809"><span class="annot"><span class="annottext">xs :: [a]
</span><a href="#local-6989586621679047809"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
</span><a href="#local-6989586621679047814"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679047811"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679047810"><span class="hs-identifier hs-var">y</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679047810"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-133"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a
</span><a href="#local-6989586621679047813"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679047810"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679047809"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>        </span><span class="annot"><a href="#local-6989586621679047813"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679047808"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621679047808"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679047808"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-135"></span><span>        </span><span class="annot"><a href="#local-6989586621679047813"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; a
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;did not converge&quot;</span></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="hs-comment">-- | A sequence of convergents approximating @sqrt 10005@, intended to be zipped</span><span>
</span><span id="line-138"></span><span class="hs-comment">-- with 'chudnovsky' in 'rationalApproximations'. Carefully chosen so that</span><span>
</span><span id="line-139"></span><span class="hs-comment">-- the denominator does not increase too rapidly but approximations are still</span><span>
</span><span id="line-140"></span><span class="hs-comment">-- appropriately precise.</span><span>
</span><span id="line-141"></span><span class="hs-comment">--</span><span>
</span><span id="line-142"></span><span class="hs-comment">-- Chudnovsky's series provides no more than 15 digits</span><span>
</span><span id="line-143"></span><span class="hs-comment">-- per iteration, so the root approximation should not</span><span>
</span><span id="line-144"></span><span class="hs-comment">-- have a more rapid rate of convergence.</span><span>
</span><span id="line-145"></span><span class="annot"><a href="Data.ExactPi.html#rootApproximation"><span class="hs-identifier hs-type">rootApproximation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span class="hs-special">]</span><span>
</span><span id="line-146"></span><span id="rootApproximation"><span class="annot"><span class="annottext">rootApproximation :: [Rational]
</span><a href="Data.ExactPi.html#rootApproximation"><span class="hs-identifier hs-var hs-var">rootApproximation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Rational] -&gt; Rational) -&gt; [[Rational]] -&gt; [Rational]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[Rational] -&gt; Rational
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">([[Rational]] -&gt; [Rational])
-&gt; ([Rational] -&gt; [[Rational]]) -&gt; [Rational] -&gt; [Rational]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">([Rational] -&gt; [Rational]) -&gt; [Rational] -&gt; [[Rational]]
forall a. (a -&gt; a) -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">iterate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [Rational] -&gt; [Rational]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="hs-number">4</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Rational] -&gt; [Rational]) -&gt; [Rational] -&gt; [Rational]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer -&gt; Integer -&gt; Integer -&gt; [Rational]
forall t. Integral t =&gt; t -&gt; t -&gt; t -&gt; t -&gt; t -&gt; [Ratio t]
</span><a href="#local-6989586621679047804"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="hs-number">100</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="hs-number">40</span></span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-148"></span><span>    </span><span id="local-6989586621679047804"><span class="annot"><span class="annottext">go :: t -&gt; t -&gt; t -&gt; t -&gt; t -&gt; [Ratio t]
</span><a href="#local-6989586621679047804"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679047803"><span class="annot"><span class="annottext">pk' :: t
</span><a href="#local-6989586621679047803"><span class="hs-identifier hs-var">pk'</span></a></span></span><span> </span><span id="local-6989586621679047802"><span class="annot"><span class="annottext">qk' :: t
</span><a href="#local-6989586621679047802"><span class="hs-identifier hs-var">qk'</span></a></span></span><span> </span><span id="local-6989586621679047801"><span class="annot"><span class="annottext">pk :: t
</span><a href="#local-6989586621679047801"><span class="hs-identifier hs-var">pk</span></a></span></span><span> </span><span id="local-6989586621679047800"><span class="annot"><span class="annottext">qk :: t
</span><a href="#local-6989586621679047800"><span class="hs-identifier hs-var">qk</span></a></span></span><span> </span><span id="local-6989586621679047799"><span class="annot"><span class="annottext">a :: t
</span><a href="#local-6989586621679047799"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679047801"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; Ratio t
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679047800"><span class="hs-identifier hs-var">qk</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Ratio t -&gt; [Ratio t] -&gt; [Ratio t]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; t -&gt; t -&gt; t -&gt; [Ratio t]
</span><a href="#local-6989586621679047804"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679047801"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679047800"><span class="hs-identifier hs-var">qk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679047803"><span class="hs-identifier hs-var">pk'</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679047799"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679047801"><span class="hs-identifier hs-var">pk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679047802"><span class="hs-identifier hs-var">qk'</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679047799"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679047800"><span class="hs-identifier hs-var">qk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">240</span></span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679047799"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679047794"><span id="local-6989586621679047797"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Data.ExactPi.html#ExactPi"><span class="hs-identifier hs-type">ExactPi</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-151"></span><span>  </span><span id="local-6989586621679047792"><span class="annot"><span class="annottext">show :: ExactPi -&gt; [Char]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ExactPi.html#Exact"><span class="hs-identifier hs-type">Exact</span></a></span><span> </span><span id="local-6989586621679047790"><span class="annot"><span class="annottext">z :: Integer
</span><a href="#local-6989586621679047790"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span id="local-6989586621679047789"><span class="annot"><span class="annottext">q :: Rational
</span><a href="#local-6989586621679047789"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679047790"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;Exactly &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679047789"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-152"></span><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679047790"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;Exactly pi * &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679047789"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-153"></span><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;Exactly pi^&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679047790"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot; * &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679047789"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-154"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ExactPi.html#Approximate"><span class="hs-identifier hs-type">Approximate</span></a></span><span> </span><span id="local-6989586621679047788"><span class="annot"><span class="annottext">x :: forall a. Floating a =&gt; a
</span><a href="#local-6989586621679047788"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;Approximately &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><a href="#local-6989586621679047788"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679047785"><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="Data.ExactPi.html#ExactPi"><span class="hs-identifier hs-type">ExactPi</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-157"></span><span>  </span><span id="local-6989586621679047778"><span class="annot"><span class="annottext">fromInteger :: Integer -&gt; ExactPi
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fromInteger</span></span></span><span> </span><span id="local-6989586621679047777"><span class="annot"><span class="annottext">n :: Integer
</span><a href="#local-6989586621679047777"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Rational -&gt; ExactPi
</span><a href="Data.ExactPi.html#Exact"><span class="hs-identifier hs-var">Exact</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Rational
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679047777"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Data.ExactPi.html#Exact"><span class="hs-identifier hs-type">Exact</span></a></span><span> </span><span id="local-6989586621679047776"><span class="annot"><span class="annottext">z1 :: Integer
</span><a href="#local-6989586621679047776"><span class="hs-identifier hs-var">z1</span></a></span></span><span> </span><span id="local-6989586621679047775"><span class="annot"><span class="annottext">q1 :: Rational
</span><a href="#local-6989586621679047775"><span class="hs-identifier hs-var">q1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679047774"><span class="annot"><span class="annottext">* :: ExactPi -&gt; ExactPi -&gt; ExactPi
</span><a href="#local-6989586621679047774"><span class="hs-operator hs-var hs-var hs-var hs-var">*</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ExactPi.html#Exact"><span class="hs-identifier hs-type">Exact</span></a></span><span> </span><span id="local-6989586621679047773"><span class="annot"><span class="annottext">z2 :: Integer
</span><a href="#local-6989586621679047773"><span class="hs-identifier hs-var">z2</span></a></span></span><span> </span><span id="local-6989586621679047772"><span class="annot"><span class="annottext">q2 :: Rational
</span><a href="#local-6989586621679047772"><span class="hs-identifier hs-var">q2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Rational -&gt; ExactPi
</span><a href="Data.ExactPi.html#Exact"><span class="hs-identifier hs-var">Exact</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679047776"><span class="hs-identifier hs-var">z1</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679047773"><span class="hs-identifier hs-var">z2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679047775"><span class="hs-identifier hs-var">q1</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679047772"><span class="hs-identifier hs-var">q2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Data.ExactPi.html#Exact"><span class="hs-identifier hs-type">Exact</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-identifier">_</span><span> </span><span class="annot"><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ExactPi.html#Exact"><span class="hs-identifier hs-type">Exact</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-161"></span><span>  </span><span id="local-6989586621679047771"><span class="annot"><span class="annottext">x :: ExactPi
</span><a href="#local-6989586621679047771"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-var">*</span></span><span> </span><span id="local-6989586621679047770"><span class="annot"><span class="annottext">y :: ExactPi
</span><a href="#local-6989586621679047770"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a. Floating a =&gt; a) -&gt; ExactPi
</span><a href="Data.ExactPi.html#Approximate"><span class="hs-identifier hs-var">Approximate</span></a></span><span> </span><span class="annot"><span class="annottext">((forall a. Floating a =&gt; a) -&gt; ExactPi)
-&gt; (forall a. Floating a =&gt; a) -&gt; ExactPi
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ExactPi -&gt; a
forall a. Floating a =&gt; ExactPi -&gt; a
</span><a href="Data.ExactPi.html#approximateValue"><span class="hs-identifier hs-var">approximateValue</span></a></span><span> </span><span class="annot"><span class="annottext">ExactPi
</span><a href="#local-6989586621679047771"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">ExactPi -&gt; a
forall a. Floating a =&gt; ExactPi -&gt; a
</span><a href="Data.ExactPi.html#approximateValue"><span class="hs-identifier hs-var">approximateValue</span></a></span><span> </span><span class="annot"><span class="annottext">ExactPi
</span><a href="#local-6989586621679047770"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Data.ExactPi.html#Exact"><span class="hs-identifier hs-type">Exact</span></a></span><span> </span><span id="local-6989586621679047769"><span class="annot"><span class="annottext">z1 :: Integer
</span><a href="#local-6989586621679047769"><span class="hs-identifier hs-var">z1</span></a></span></span><span> </span><span id="local-6989586621679047768"><span class="annot"><span class="annottext">q1 :: Rational
</span><a href="#local-6989586621679047768"><span class="hs-identifier hs-var">q1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679047767"><span class="annot"><span class="annottext">+ :: ExactPi -&gt; ExactPi -&gt; ExactPi
</span><a href="#local-6989586621679047767"><span class="hs-operator hs-var hs-var hs-var hs-var">+</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ExactPi.html#Exact"><span class="hs-identifier hs-type">Exact</span></a></span><span> </span><span id="local-6989586621679047766"><span class="annot"><span class="annottext">z2 :: Integer
</span><a href="#local-6989586621679047766"><span class="hs-identifier hs-var">z2</span></a></span></span><span> </span><span id="local-6989586621679047765"><span class="annot"><span class="annottext">q2 :: Rational
</span><a href="#local-6989586621679047765"><span class="hs-identifier hs-var">q2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679047769"><span class="hs-identifier hs-var">z1</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679047766"><span class="hs-identifier hs-var">z2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Rational -&gt; ExactPi
</span><a href="Data.ExactPi.html#Exact"><span class="hs-identifier hs-var">Exact</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679047769"><span class="hs-identifier hs-var">z1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679047768"><span class="hs-identifier hs-var">q1</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679047765"><span class="hs-identifier hs-var">q2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- by distributive property</span><span>
</span><span id="line-163"></span><span>  </span><span id="local-6989586621679047764"><span class="annot"><span class="annottext">x :: ExactPi
</span><a href="#local-6989586621679047764"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-var">+</span></span><span> </span><span id="local-6989586621679047763"><span class="annot"><span class="annottext">y :: ExactPi
</span><a href="#local-6989586621679047763"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a. Floating a =&gt; a) -&gt; ExactPi
</span><a href="Data.ExactPi.html#Approximate"><span class="hs-identifier hs-var">Approximate</span></a></span><span> </span><span class="annot"><span class="annottext">((forall a. Floating a =&gt; a) -&gt; ExactPi)
-&gt; (forall a. Floating a =&gt; a) -&gt; ExactPi
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ExactPi -&gt; a
forall a. Floating a =&gt; ExactPi -&gt; a
</span><a href="Data.ExactPi.html#approximateValue"><span class="hs-identifier hs-var">approximateValue</span></a></span><span> </span><span class="annot"><span class="annottext">ExactPi
</span><a href="#local-6989586621679047764"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">ExactPi -&gt; a
forall a. Floating a =&gt; ExactPi -&gt; a
</span><a href="Data.ExactPi.html#approximateValue"><span class="hs-identifier hs-var">approximateValue</span></a></span><span> </span><span class="annot"><span class="annottext">ExactPi
</span><a href="#local-6989586621679047763"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-164"></span><span>  </span><span id="local-6989586621679047762"><span class="annot"><span class="annottext">abs :: ExactPi -&gt; ExactPi
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">abs</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ExactPi.html#Exact"><span class="hs-identifier hs-type">Exact</span></a></span><span> </span><span id="local-6989586621679047760"><span class="annot"><span class="annottext">z :: Integer
</span><a href="#local-6989586621679047760"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span id="local-6989586621679047759"><span class="annot"><span class="annottext">q :: Rational
</span><a href="#local-6989586621679047759"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Rational -&gt; ExactPi
</span><a href="Data.ExactPi.html#Exact"><span class="hs-identifier hs-var">Exact</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679047760"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679047759"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ExactPi.html#Approximate"><span class="hs-identifier hs-type">Approximate</span></a></span><span> </span><span id="local-6989586621679047758"><span class="annot"><span class="annottext">x :: forall a. Floating a =&gt; a
</span><a href="#local-6989586621679047758"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a. Floating a =&gt; a) -&gt; ExactPi
</span><a href="Data.ExactPi.html#Approximate"><span class="hs-identifier hs-var">Approximate</span></a></span><span> </span><span class="annot"><span class="annottext">((forall a. Floating a =&gt; a) -&gt; ExactPi)
-&gt; (forall a. Floating a =&gt; a) -&gt; ExactPi
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="annot"><span class="annottext">a
forall a. Floating a =&gt; a
</span><a href="#local-6989586621679047758"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-166"></span><span>  </span><span id="local-6989586621679047757"><span class="annot"><span class="annottext">signum :: ExactPi -&gt; ExactPi
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">signum</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ExactPi.html#Exact"><span class="hs-identifier hs-type">Exact</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679047755"><span class="annot"><span class="annottext">q :: Rational
</span><a href="#local-6989586621679047755"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Rational -&gt; ExactPi
</span><a href="Data.ExactPi.html#Exact"><span class="hs-identifier hs-var">Exact</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">signum</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679047755"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">signum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ExactPi.html#Approximate"><span class="hs-identifier hs-type">Approximate</span></a></span><span> </span><span id="local-6989586621679047754"><span class="annot"><span class="annottext">x :: forall a. Floating a =&gt; a
</span><a href="#local-6989586621679047754"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a. Floating a =&gt; a) -&gt; ExactPi
</span><a href="Data.ExactPi.html#Approximate"><span class="hs-identifier hs-var">Approximate</span></a></span><span> </span><span class="annot"><span class="annottext">((forall a. Floating a =&gt; a) -&gt; ExactPi)
-&gt; (forall a. Floating a =&gt; a) -&gt; ExactPi
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">signum</span></span><span> </span><span class="annot"><span class="annottext">a
forall a. Floating a =&gt; a
</span><a href="#local-6989586621679047754"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-comment">-- we leave this tagged as approximate because we don't know &quot;how&quot; approximate the input was. a case could be made for exact answers here.</span><span>
</span><span id="line-168"></span><span>  </span><span id="local-6989586621679047753"><span class="annot"><span class="annottext">negate :: ExactPi -&gt; ExactPi
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">negate</span></span></span><span> </span><span id="local-6989586621679047752"><span class="annot"><span class="annottext">x :: ExactPi
</span><a href="#local-6989586621679047752"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Rational -&gt; ExactPi
</span><a href="Data.ExactPi.html#Exact"><span class="hs-identifier hs-var">Exact</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ExactPi -&gt; ExactPi -&gt; ExactPi
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">ExactPi
</span><a href="#local-6989586621679047752"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679047749"><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="Data.ExactPi.html#ExactPi"><span class="hs-identifier hs-type">ExactPi</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-171"></span><span>  </span><span id="local-6989586621679047745"><span class="annot"><span class="annottext">fromRational :: Rational -&gt; ExactPi
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fromRational</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Rational -&gt; ExactPi
</span><a href="Data.ExactPi.html#Exact"><span class="hs-identifier hs-var">Exact</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-172"></span><span>  </span><span id="local-6989586621679047744"><span class="annot"><span class="annottext">recip :: ExactPi -&gt; ExactPi
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">recip</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ExactPi.html#Exact"><span class="hs-identifier hs-type">Exact</span></a></span><span> </span><span id="local-6989586621679047742"><span class="annot"><span class="annottext">z :: Integer
</span><a href="#local-6989586621679047742"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span id="local-6989586621679047741"><span class="annot"><span class="annottext">q :: Rational
</span><a href="#local-6989586621679047741"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Rational -&gt; ExactPi
</span><a href="Data.ExactPi.html#Exact"><span class="hs-identifier hs-var">Exact</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679047742"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Rational
forall a. Fractional a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">recip</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679047741"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">recip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ExactPi.html#Approximate"><span class="hs-identifier hs-type">Approximate</span></a></span><span> </span><span id="local-6989586621679047740"><span class="annot"><span class="annottext">x :: forall a. Floating a =&gt; a
</span><a href="#local-6989586621679047740"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a. Floating a =&gt; a) -&gt; ExactPi
</span><a href="Data.ExactPi.html#Approximate"><span class="hs-identifier hs-var">Approximate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a
forall a. Fractional a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">recip</span></span><span> </span><span class="annot"><span class="annottext">a
forall a. Floating a =&gt; a
</span><a href="#local-6989586621679047740"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679047710"><span id="local-6989586621679047712"><span id="local-6989586621679047714"><span id="local-6989586621679047716"><span id="local-6989586621679047730"><span id="local-6989586621679047732"><span id="local-6989586621679047734"><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="annot"><a href="Data.ExactPi.html#ExactPi"><span class="hs-identifier hs-type">ExactPi</span></a></span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-176"></span><span>  </span><span id="local-6989586621679047708"><span class="annot"><span class="annottext">pi :: ExactPi
</span><a href="#local-6989586621679047708"><span class="hs-identifier hs-var hs-var hs-var hs-var">pi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Rational -&gt; ExactPi
</span><a href="Data.ExactPi.html#Exact"><span class="hs-identifier hs-var">Exact</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-177"></span><span>  </span><span id="local-6989586621679047707"><span class="annot"><span class="annottext">exp :: ExactPi -&gt; ExactPi
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">exp</span></span></span><span> </span><span id="local-6989586621679047705"><span class="annot"><span class="annottext">x :: ExactPi
</span><a href="#local-6989586621679047705"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ExactPi -&gt; Bool
</span><a href="Data.ExactPi.html#isExactZero"><span class="hs-identifier hs-var">isExactZero</span></a></span><span> </span><span class="annot"><span class="annottext">ExactPi
</span><a href="#local-6989586621679047705"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-178"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a. Floating a =&gt; a -&gt; a) -&gt; ExactPi -&gt; ExactPi
</span><a href="Data.ExactPi.html#approx1"><span class="hs-identifier hs-var">approx1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">exp</span></span><span> </span><span class="annot"><span class="annottext">ExactPi
</span><a href="#local-6989586621679047705"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-179"></span><span>  </span><span id="local-6989586621679047703"><span class="annot"><span class="annottext">log :: ExactPi -&gt; ExactPi
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">log</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ExactPi.html#Exact"><span class="hs-identifier hs-type">Exact</span></a></span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-180"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">log</span></span><span> </span><span id="local-6989586621679047701"><span class="annot"><span class="annottext">x :: ExactPi
</span><a href="#local-6989586621679047701"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a. Floating a =&gt; a -&gt; a) -&gt; ExactPi -&gt; ExactPi
</span><a href="Data.ExactPi.html#approx1"><span class="hs-identifier hs-var">approx1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">log</span></span><span> </span><span class="annot"><span class="annottext">ExactPi
</span><a href="#local-6989586621679047701"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-comment">-- It would be possible to give tighter bounds to the trig functions, preserving exactness for arguments that have an exactly representable result.</span><span>
</span><span id="line-182"></span><span>  </span><span id="local-6989586621679047700"><span class="annot"><span class="annottext">sin :: ExactPi -&gt; ExactPi
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">sin</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a. Floating a =&gt; a -&gt; a) -&gt; ExactPi -&gt; ExactPi
</span><a href="Data.ExactPi.html#approx1"><span class="hs-identifier hs-var">approx1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span>
</span><span id="line-183"></span><span>  </span><span id="local-6989586621679047698"><span class="annot"><span class="annottext">cos :: ExactPi -&gt; ExactPi
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">cos</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a. Floating a =&gt; a -&gt; a) -&gt; ExactPi -&gt; ExactPi
</span><a href="Data.ExactPi.html#approx1"><span class="hs-identifier hs-var">approx1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span>
</span><span id="line-184"></span><span>  </span><span id="local-6989586621679047696"><span class="annot"><span class="annottext">tan :: ExactPi -&gt; ExactPi
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">tan</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a. Floating a =&gt; a -&gt; a) -&gt; ExactPi -&gt; ExactPi
</span><a href="Data.ExactPi.html#approx1"><span class="hs-identifier hs-var">approx1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">tan</span></span><span>
</span><span id="line-185"></span><span>  </span><span id="local-6989586621679047694"><span class="annot"><span class="annottext">asin :: ExactPi -&gt; ExactPi
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">asin</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a. Floating a =&gt; a -&gt; a) -&gt; ExactPi -&gt; ExactPi
</span><a href="Data.ExactPi.html#approx1"><span class="hs-identifier hs-var">approx1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">asin</span></span><span>
</span><span id="line-186"></span><span>  </span><span id="local-6989586621679047692"><span class="annot"><span class="annottext">atan :: ExactPi -&gt; ExactPi
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">atan</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a. Floating a =&gt; a -&gt; a) -&gt; ExactPi -&gt; ExactPi
</span><a href="Data.ExactPi.html#approx1"><span class="hs-identifier hs-var">approx1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">atan</span></span><span>
</span><span id="line-187"></span><span>  </span><span id="local-6989586621679047690"><span class="annot"><span class="annottext">acos :: ExactPi -&gt; ExactPi
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">acos</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a. Floating a =&gt; a -&gt; a) -&gt; ExactPi -&gt; ExactPi
</span><a href="Data.ExactPi.html#approx1"><span class="hs-identifier hs-var">approx1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">acos</span></span><span>
</span><span id="line-188"></span><span>  </span><span id="local-6989586621679047688"><span class="annot"><span class="annottext">sinh :: ExactPi -&gt; ExactPi
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">sinh</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a. Floating a =&gt; a -&gt; a) -&gt; ExactPi -&gt; ExactPi
</span><a href="Data.ExactPi.html#approx1"><span class="hs-identifier hs-var">approx1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sinh</span></span><span>
</span><span id="line-189"></span><span>  </span><span id="local-6989586621679047686"><span class="annot"><span class="annottext">cosh :: ExactPi -&gt; ExactPi
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">cosh</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a. Floating a =&gt; a -&gt; a) -&gt; ExactPi -&gt; ExactPi
</span><a href="Data.ExactPi.html#approx1"><span class="hs-identifier hs-var">approx1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cosh</span></span><span>
</span><span id="line-190"></span><span>  </span><span id="local-6989586621679047684"><span class="annot"><span class="annottext">tanh :: ExactPi -&gt; ExactPi
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">tanh</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a. Floating a =&gt; a -&gt; a) -&gt; ExactPi -&gt; ExactPi
</span><a href="Data.ExactPi.html#approx1"><span class="hs-identifier hs-var">approx1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">tanh</span></span><span>
</span><span id="line-191"></span><span>  </span><span id="local-6989586621679047682"><span class="annot"><span class="annottext">asinh :: ExactPi -&gt; ExactPi
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">asinh</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a. Floating a =&gt; a -&gt; a) -&gt; ExactPi -&gt; ExactPi
</span><a href="Data.ExactPi.html#approx1"><span class="hs-identifier hs-var">approx1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">asinh</span></span><span>
</span><span id="line-192"></span><span>  </span><span id="local-6989586621679047680"><span class="annot"><span class="annottext">acosh :: ExactPi -&gt; ExactPi
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">acosh</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a. Floating a =&gt; a -&gt; a) -&gt; ExactPi -&gt; ExactPi
</span><a href="Data.ExactPi.html#approx1"><span class="hs-identifier hs-var">approx1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">acosh</span></span><span>
</span><span id="line-193"></span><span>  </span><span id="local-6989586621679047678"><span class="annot"><span class="annottext">atanh :: ExactPi -&gt; ExactPi
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">atanh</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a. Floating a =&gt; a -&gt; a) -&gt; ExactPi -&gt; ExactPi
</span><a href="Data.ExactPi.html#approx1"><span class="hs-identifier hs-var">approx1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">atanh</span></span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="annot"><a href="Data.ExactPi.html#approx1"><span class="hs-identifier hs-type">approx1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679047886"><span class="annot"><a href="#local-6989586621679047886"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="annot"><a href="#local-6989586621679047886"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679047886"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679047886"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ExactPi.html#ExactPi"><span class="hs-identifier hs-type">ExactPi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ExactPi.html#ExactPi"><span class="hs-identifier hs-type">ExactPi</span></a></span><span>
</span><span id="line-196"></span><span id="approx1"><span class="annot"><span class="annottext">approx1 :: (forall a. Floating a =&gt; a -&gt; a) -&gt; ExactPi -&gt; ExactPi
</span><a href="Data.ExactPi.html#approx1"><span class="hs-identifier hs-var hs-var">approx1</span></a></span></span><span> </span><span id="local-6989586621679047676"><span class="annot"><span class="annottext">f :: forall a. Floating a =&gt; a -&gt; a
</span><a href="#local-6989586621679047676"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679047675"><span class="annot"><span class="annottext">x :: ExactPi
</span><a href="#local-6989586621679047675"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a. Floating a =&gt; a) -&gt; ExactPi
</span><a href="Data.ExactPi.html#Approximate"><span class="hs-identifier hs-var">Approximate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a
forall a. Floating a =&gt; a -&gt; a
</span><a href="#local-6989586621679047676"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExactPi -&gt; a
forall a. Floating a =&gt; ExactPi -&gt; a
</span><a href="Data.ExactPi.html#approximateValue"><span class="hs-identifier hs-var">approximateValue</span></a></span><span> </span><span class="annot"><span class="annottext">ExactPi
</span><a href="#local-6989586621679047675"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="hs-comment">-- | The multiplicative semigroup over 'Rational's augmented with multiples of 'pi'.</span><span>
</span><span id="line-199"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679047670"><span id="local-6989586621679047672"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="Data.ExactPi.html#ExactPi"><span class="hs-identifier hs-type">ExactPi</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-200"></span><span>  </span><span id="local-6989586621679047668"><span class="annot"><span class="annottext">&lt;&gt; :: ExactPi -&gt; ExactPi -&gt; ExactPi
</span><span class="hs-operator hs-var hs-var hs-var hs-var">(&lt;&gt;)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExactPi -&gt; ExactPi -&gt; ExactPi
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">mappend</span></span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="hs-comment">-- | The multiplicative monoid over 'Rational's augmented with multiples of 'pi'.</span><span>
</span><span id="line-203"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679047663"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="Data.ExactPi.html#ExactPi"><span class="hs-identifier hs-type">ExactPi</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-204"></span><span>  </span><span id="local-6989586621679047661"><span class="annot"><span class="annottext">mempty :: ExactPi
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-205"></span><span>  </span><span id="local-6989586621679047660"><span class="annot"><span class="annottext">mappend :: ExactPi -&gt; ExactPi -&gt; ExactPi
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mappend</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExactPi -&gt; ExactPi -&gt; ExactPi
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(*)</span></span><span>
</span><span id="line-206"></span></pre></body></html>